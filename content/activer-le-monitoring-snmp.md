Title:Activer le monitoring snmp
Date:2010-10-01
Tags: Trucs et astuces,Linux,Xen,  mediawiki

snmp
----

quelques notes pour déployer rapidement du snmp sur des machines
virtuelles Xen

installer snmpd

` apt-get install snmpd`

#### debian lenny

modifier le fichier de conf /etc/snmp/snmpd.conf

`#       sec.name  source          community`\
`#com2sec paranoid  default         public`\
`#com2sec readonly  default         public`\
`com2sec readonly  192.168.1.0/24         public`\
`...`\
`#disk / 10000`\
`disk /`

modifier le fichier /etc/default/snmpd

`#SNMPDOPTS='-Lsd -Lf /dev/null -u snmp -I -smux -p /var/run/snmpd.pid 127.0.0.1'`\
`SNMPDOPTS='-Lsd -Lf /dev/null -u snmp -I -smux -p /var/run/snmpd.pid'`

#### debian squeeze

modifier le fichier de conf /etc/snmp/snmpd.conf

`#agentAddress  `[`udp:127.0.0.1:161`](udp:127.0.0.1:161)\
`agentAddress  `[`udp:0.0.0.0:161`](udp:0.0.0.0:161)\
`...`\
`#rocommunity public  default    -V systemonly`\
`rocommunity public  cacti.tcweb.org.`

#### enfin

reboot de snmpd

`/etc/init.d/snmpd restart`

dans cacti faire un nouveau host basé sur le schéma "ucd/net SNMP host"

apache
------

`a2enmod status`

Modifier /etc/apache2/mods-available/status.conf


    <IfModule mod_status.c>
    #
    # Allow server status reports generated by mod_status,
    # with the URL of http://servername/server-status
    # Uncomment and change the ".example.com" to allow
    # access from other hosts.
    #
    <Location /server-status>
        SetHandler server-status
        Order deny,allow
        Deny from all
        Allow from localhost ip6-localhost
        Allow from cacti.tcweb.org
    </Location>

    ExtendedStatus on

    </IfModule>
